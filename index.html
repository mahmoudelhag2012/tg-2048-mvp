<script>
  /* ... بيفضل كل كودك زي ما هو فوق ... */

  /* ===== Inputs: touch / mouse / keyboard ===== */
  const startPos = { x: 0, y: 0 };
  let dragging = false;

  function onStart(e) {
    dragging = true;
    const t = e.touches ? e.touches[0] : e;
    startPos.x = t.clientX;
    startPos.y = t.clientY;
  }

  function onEnd(e) {
    if (!dragging) return;
    dragging = false;
    const t = e.changedTouches ? e.changedTouches[0] : e;
    const dx = t.clientX - startPos.x;
    const dy = t.clientY - startPos.y;
    if (Math.abs(dx) > Math.abs(dy)) {
      // أفقى: يمين / شمال
      move(dx > 0 ? 2 : 0);   // 0=Left, 2=Right
    } else {
      // رأسي: فوق / تحت
      move(dy > 0 ? 3 : 1);   // 1=Up, 3=Down
    }
  }

  // اربطهم باللوحة
  gridEl.addEventListener('touchstart', onStart, { passive: true });
  gridEl.addEventListener('touchend', onEnd);
  gridEl.addEventListener('mousedown', onStart);
  gridEl.addEventListener('mouseup', onEnd);

  // أزرار الاتجاهات (لو مش موجودين بالفعل)
  document.getElementById('left').onclick  = () => move(0);
  document.getElementById('up').onclick    = () => move(1);
  document.getElementById('right').onclick = () => move(2);
  document.getElementById('down').onclick  = () => move(3);

  // دعم الكيبورد كمان (اختياري)
  window.addEventListener('keydown', (e) => {
    if (e.key === 'ArrowLeft')  move(0);
    if (e.key === 'ArrowUp')    move(1);
    if (e.key === 'ArrowRight') move(2);
    if (e.key === 'ArrowDown')  move(3);
  });

  /* ... وباقي كودك بعده زي ما هو ... */
</script>
